<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.review.front.frontOrder.mapper.FrontOrderMapper">

    <select id="getOrderList" parameterType="map" resultType="com.review.manage.reviewOrder.vo.ReviewOrderVO">
        SELECT
            o.id,
            o.order_no orderNo,
            o.class_name className,
            o.class_id classId,
            DATE_FORMAT( o.operate_time, '%Y-%m-%e %H:%i:%S' ) AS operateTime,
            c.banner_img bannerImg,
            ( SELECT count( 1 ) FROM review_class rc WHERE rc.class_id = o.class_id ) AS isExistClass
        FROM
            review_order o
                LEFT JOIN review_class c ON o.class_id = c.class_id
        WHERE
            user_id = #{userId}
          AND o.status in (#{preSuccess},#{success})
        ORDER BY o.operate_time desc
    </select>
</mapper>