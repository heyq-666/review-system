<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.review.manage.expert.mapper.ReviewExpertMapper">
    <select id="getCalendarDetailList" parameterType="com.review.manage.expert.entity.ReviewExpertCalendarEntity" resultType="com.review.manage.expert.vo.ReviewExpertCalendarVo">
        SELECT
            c.id,
            c.expert_id expertId,
            c.week_day weekDay,
            CASE
                c.week_day
                WHEN '1' THEN
                    '周一'
                WHEN '2' THEN
                    '周二'
                WHEN '3' THEN
                    '周三'
                WHEN '4' THEN
                    '周四'
                WHEN '5' THEN
                    '周五'
                WHEN '6' THEN
                    '周六'
                WHEN '0' THEN
                    '周日'
                END weekDayName,
            c.STATUS,
            DATE_FORMAT( c.`visit_date`, '%Y-%m-%e' ) AS visitDate,
            DATE_FORMAT( c.begin_time, '%H:%i' ) AS beginTime,
            DATE_FORMAT( c.end_time, '%H:%i' ) AS endTime,
            DATE_FORMAT( c.create_time, '%Y-%m-%e %H:%i:%S' ) AS createTime,
            CONCAT(DATE_FORMAT( c.`begin_time`, '%H:%i' ),'-',DATE_FORMAT( c.`end_time`, '%H:%i' )) AS timeSlot
        FROM
            review_expert_calendar c
        WHERE
            c.expert_id = #{expertId}
            /*AND c.STATUS = 1
            AND c.visit_date >= DATE_FORMAT( now( ), '%Y-%m-%e' ) */
            <if test="visitDate != null">
                and c.visit_date >= #{visitDate}
            </if>
        ORDER BY
            c.visit_date,
            c.begin_time ASC
    </select>
</mapper>